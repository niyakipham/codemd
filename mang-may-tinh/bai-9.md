# B√†i H·ªçc 09: Subnetting (Chia M·∫°ng Con) - Ngh·ªá Thu·∫≠t Ph√¢n Chia ƒê·ªãa Ch·ªâ IP ‚úÇÔ∏èüìä

## M·ª•c Ti√™u B√†i H·ªçc

*   Hi·ªÉu r√µ **t·∫°i sao c·∫ßn ph·∫£i chia m·∫°ng con (Subnetting)**.
*   N·∫Øm v·ªØng kh√°i ni·ªám "m∆∞·ª£n bit" t·ª´ ph·∫ßn Host ID ƒë·ªÉ t·∫°o Subnet ID.
*   Hi·ªÉu c√°ch **Subnet Mask t√πy ch·ªânh (Custom Subnet Mask)** ho·∫°t ƒë·ªông.
*   Th·ª±c h√†nh c√°c b∆∞·ªõc t√≠nh to√°n khi chia m·∫°ng con:
    *   X√°c ƒë·ªãnh s·ªë l∆∞·ª£ng Subnet t·∫°o ra.
    *   X√°c ƒë·ªãnh s·ªë l∆∞·ª£ng Host/Subnet.
    *   T√¨m Network Address, d·∫£i ƒë·ªãa ch·ªâ Host h·ª£p l·ªá, v√† Broadcast Address cho t·ª´ng Subnet.
*   L√†m quen v·ªõi **k√Ω ph√°p CIDR (Classless Inter-Domain Routing)** trong Subnetting.
*   Hi·ªÉu s∆° l∆∞·ª£c v·ªÅ **VLSM (Variable Length Subnet Mask)** - M·∫∑t n·∫° m·∫°ng con c√≥ ƒë·ªô d√†i thay ƒë·ªïi.

## N·ªôi Dung Chi Ti·∫øt

### 1. T·∫°i Sao C·∫ßn Chia M·∫°ng Con (Subnetting)?

H√£y t∆∞·ªüng t∆∞·ª£ng b·∫°n ƒë∆∞·ª£c c·∫•p m·ªôt d·∫£i ƒë·ªãa ch·ªâ l·ªõn thu·ªôc Class B, v√≠ d·ª•: `172.16.0.0 /16`. D·∫£i n√†y cho ph√©p b·∫°n c√≥ t·ªõi 65,534 thi·∫øt b·ªã trong c√πng m·ªôt m·∫°ng. N·∫øu b·∫°n ch·ªâ c√≥ v√†i trƒÉm ho·∫∑c v√†i ngh√¨n thi·∫øt b·ªã trong t·ªï ch·ª©c c·ªßa m√¨nh, vi·ªác s·ª≠ d·ª•ng c·∫£ d·∫£i ƒë·ªãa ch·ªâ l·ªõn n√†y cho m·ªôt m·∫°ng duy nh·∫•t s·∫Ω g√¢y ra nhi·ªÅu v·∫•n ƒë·ªÅ:

*   **L√£ng ph√≠ ƒë·ªãa ch·ªâ IP:** R·∫•t nhi·ªÅu ƒë·ªãa ch·ªâ kh√¥ng ƒë∆∞·ª£c s·ª≠ d·ª•ng.
*   **Hi·ªáu su·∫•t m·∫°ng k√©m:** T·∫°o ra m·ªôt **Broadcast Domain (Mi·ªÅn qu·∫£ng b√°)** c·ª±c l·ªõn. B·∫•t k·ª≥ m·ªôt b·∫£n tin broadcast n√†o (v√≠ d·ª•: ARP Request) c≈©ng s·∫Ω b·ªã g·ª≠i ƒë·∫øn t·∫•t c·∫£ 65,534 thi·∫øt b·ªã, g√¢y t·∫Øc ngh·∫Ωn v√† l√†m ch·∫≠m m·∫°ng.
*   **Kh√≥ qu·∫£n l√Ω:** Qu·∫£n l√Ω an ninh, ph√¢n chia ph√≤ng ban, x·ª≠ l√Ω s·ª± c·ªë tr√™n m·ªôt m·∫°ng l·ªõn duy nh·∫•t r·∫•t ph·ª©c t·∫°p.
*   **K√©m linh ho·∫°t:** Kh√≥ khƒÉn trong vi·ªác √°p d·ª•ng c√°c ch√≠nh s√°ch b·∫£o m·∫≠t ho·∫∑c QoS kh√°c nhau cho t·ª´ng nh√≥m ng∆∞·ªùi d√πng/thi·∫øt b·ªã.

**Gi·∫£i ph√°p:** **Subnetting (Chia m·∫°ng con)!**

Subnetting l√† k·ªπ thu·∫≠t **chia m·ªôt d·∫£i ƒë·ªãa ch·ªâ m·∫°ng l·ªõn (Network ID) th√†nh nhi·ªÅu d·∫£i ƒë·ªãa ch·ªâ m·∫°ng con (Subnet ID) nh·ªè h∆°n**. M·ªói Subnet s·∫Ω l√† m·ªôt **Broadcast Domain ri√™ng bi·ªát**, gi√∫p gi·∫£i quy·∫øt c√°c v·∫•n ƒë·ªÅ tr√™n:

*   **Ti·∫øt ki·ªám ƒë·ªãa ch·ªâ IP:** S·ª≠ d·ª•ng ƒë·ªãa ch·ªâ hi·ªáu qu·∫£ h∆°n.
*   **TƒÉng hi·ªáu su·∫•t m·∫°ng:** Gi·∫£m k√≠ch th∆∞·ªõc c·ªßa Broadcast Domain, h·∫°n ch·∫ø l∆∞u l∆∞·ª£ng broadcast kh√¥ng c·∫ßn thi·∫øt.
*   **D·ªÖ qu·∫£n l√Ω v√† tƒÉng c∆∞·ªùng b·∫£o m·∫≠t:** C√≥ th·ªÉ nh√≥m c√°c thi·∫øt b·ªã theo ph√≤ng ban, ch·ª©c nƒÉng ho·∫∑c v·ªã tr√≠ ƒë·ªãa l√Ω v√†o c√°c Subnet ri√™ng. √Åp d·ª•ng c√°c ch√≠nh s√°ch truy c·∫≠p (Access Control List - ACL) gi·ªØa c√°c Subnet d·ªÖ d√†ng h∆°n.
*   **TƒÉng t√≠nh linh ho·∫°t:** T·ªï ch·ª©c c·∫•u tr√∫c m·∫°ng logic h∆°n.

### 2. Kh√°i Ni·ªám "M∆∞·ª£n Bit" v√† Subnet Mask T√πy Ch·ªânh

Subnetting ho·∫°t ƒë·ªông d·ª±a tr√™n nguy√™n t·∫Øc **"m∆∞·ª£n" m·ªôt s·ªë bit t·ª´ ph·∫ßn Host ID c·ªßa ƒë·ªãa ch·ªâ IP g·ªëc ƒë·ªÉ t·∫°o th√†nh ph·∫ßn Subnet ID m·ªõi.**

*   ƒê·ªãa ch·ªâ IP b√¢y gi·ªù ƒë∆∞·ª£c chia th√†nh 3 ph·∫ßn: **Network ID** (gi·ªØ nguy√™n) | **Subnet ID** (c√°c bit m∆∞·ª£n) | **Host ID** (c√°c bit c√≤n l·∫°i).
*   ƒê·ªÉ h·ªá th·ªëng (m√°y t√≠nh, router) bi·∫øt ƒë∆∞·ª£c bao nhi√™u bit ƒë√£ ƒë∆∞·ª£c m∆∞·ª£n l√†m Subnet ID, ch√∫ng ta s·ª≠ d·ª•ng m·ªôt **Subnet Mask t√πy ch·ªânh (Custom Subnet Mask)**. Subnet Mask t√πy ch·ªânh s·∫Ω c√≥ nhi·ªÅu bit `1` h∆°n so v·ªõi Subnet Mask m·∫∑c ƒë·ªãnh c·ªßa l·ªõp ƒë·ªãa ch·ªâ ƒë√≥. C√°c bit `1` b·ªï sung n√†y ch√≠nh l√† c√°c bit ƒë√£ ƒë∆∞·ª£c m∆∞·ª£n.

**V√≠ d·ª•:**

*   ƒê·ªãa ch·ªâ m·∫°ng g·ªëc: `192.168.1.0 /24` (Class C)
    *   Network ID: `192.168.1` (24 bit)
    *   Host ID: 8 bit cu·ªëi (cho ph√©p 2‚Å∏-2 = 254 host)
    *   Subnet Mask m·∫∑c ƒë·ªãnh: `255.255.255.0` (Nh·ªã ph√¢n: `11111111.11111111.11111111.00000000`)
*   **Quy·∫øt ƒë·ªãnh:** Ch√∫ng ta mu·ªën chia m·∫°ng n√†y th√†nh nhi·ªÅu Subnet nh·ªè h∆°n. Gi·∫£ s·ª≠ ch√∫ng ta **m∆∞·ª£n 3 bit** t·ª´ ph·∫ßn Host ID ƒë·ªÉ l√†m Subnet ID.
*   **Subnet Mask t√πy ch·ªânh:** Ch√∫ng ta "b·∫≠t" 3 bit ƒë·∫ßu ti√™n c·ªßa ph·∫ßn Host ID trong Subnet Mask l√™n th√†nh `1`.
    *   Subnet Mask m·ªõi (nh·ªã ph√¢n): `11111111.11111111.11111111.11100000`
    *   Subnet Mask m·ªõi (th·∫≠p ph√¢n): `255.255.255.224`
    *   K√Ω ph√°p CIDR m·ªõi: `/27` (v√¨ c√≥ 24 + 3 = 27 bit 1)
*   **C·∫•u tr√∫c m·ªõi:**
    *   Network ID: `192.168.1` (24 bit - kh√¥ng ƒë·ªïi)
    *   Subnet ID: 3 bit ti·∫øp theo (c√°c bit m∆∞·ª£n)
    *   Host ID: 5 bit cu·ªëi (8 - 3 = 5 bit c√≤n l·∫°i)

### 3. C√°c B∆∞·ªõc T√≠nh To√°n Khi Chia Subnet

Gi·∫£ s·ª≠ ch√∫ng ta c√≥ b√†i to√°n: Chia m·∫°ng `192.168.1.0 /24` b·∫±ng c√°ch m∆∞·ª£n 3 bit l√†m Subnet. (Subnet Mask m·ªõi l√† `255.255.255.224` hay `/27`).

**B∆∞·ªõc 1: X√°c ƒë·ªãnh s·ªë l∆∞·ª£ng Subnet t·∫°o ra**

*   S·ªë bit m∆∞·ª£n (S) = 3
*   S·ªë l∆∞·ª£ng Subnet = 2À¢ = 2¬≥ = **8 Subnet**

**B∆∞·ªõc 2: X√°c ƒë·ªãnh s·ªë l∆∞·ª£ng Host/Subnet**

*   S·ªë bit c√≤n l·∫°i cho Host ID (H) = 8 (Host ID g·ªëc) - 3 (bit m∆∞·ª£n) = 5
*   S·ªë l∆∞·ª£ng ƒë·ªãa ch·ªâ IP m·ªói Subnet = 2·¥¥ = 2‚Åµ = 32 ƒë·ªãa ch·ªâ (t√≠nh c·∫£ Network v√† Broadcast)
*   S·ªë l∆∞·ª£ng Host h·ª£p l·ªá m·ªói Subnet = 2·¥¥ - 2 = 2‚Åµ - 2 = 30 Host

**B∆∞·ªõc 3: Li·ªát k√™ c√°c Subnet (T√¨m Network Address, D·∫£i Host, Broadcast Address)**

Ch√∫ng ta c·∫ßn t√¨m Network Address, d·∫£i IP Host h·ª£p l·ªá (First Host - Last Host), v√† Broadcast Address cho t·ª´ng Subnet trong s·ªë 8 Subnet ƒë√£ t·∫°o.

*   **C√°ch t√¨m Network Address c·ªßa c√°c Subnet:** Network Address c·ªßa Subnet ƒë·∫ßu ti√™n ch√≠nh l√† Network Address c·ªßa m·∫°ng g·ªëc (`192.168.1.0`). Network Address c·ªßa c√°c Subnet ti·∫øp theo ƒë∆∞·ª£c t√≠nh b·∫±ng c√°ch c·ªông th√™m "b∆∞·ªõc nh·∫£y".
*   **B∆∞·ªõc nh·∫£y (Increment/Block Size):** L√† gi√° tr·ªã c·ªßa bit cu·ªëi c√πng ƒë∆∞·ª£c m∆∞·ª£n trong Subnet Mask, t√≠nh ·ªü octet m√† vi·ªác m∆∞·ª£n bit x·∫£y ra. Ho·∫∑c c√°ch t√≠nh ƒë∆°n gi·∫£n: `B∆∞·ªõc nh·∫£y = 256 - Gi√° tr·ªã octet c·ªßa Subnet Mask t√πy ch·ªânh` (t·∫°i octet c√≥ thay ƒë·ªïi).
    *   Trong v√≠ d·ª•: M∆∞·ª£n bit ·ªü octet th·ª© 4. Gi√° tr·ªã octet 4 c·ªßa Mask l√† 224.
    *   B∆∞·ªõc nh·∫£y = 256 - 224 = **32**.
    *   ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† Network Address c·ªßa c√°c Subnet s·∫Ω c√°ch nhau 32 ƒë∆°n v·ªã ·ªü octet th·ª© 4.

*   **Li·ªát k√™:**
    *   **Subnet 1:**
        *   Network Address: `192.168.1.0` (Subnet ƒë·∫ßu ti√™n)
        *   First Host: `192.168.1.1` (Network Address + 1)
        *   Last Host: `192.168.1.30` (Broadcast Address - 1)
        *   Broadcast Address: `192.168.1.31` (Network Address ti·∫øp theo - 1)
    *   **Subnet 2:**
        *   Network Address: `192.168.1.32` (`192.168.1.0 + 32`)
        *   First Host: `192.168.1.33`
        *   Last Host: `192.168.1.62`
        *   Broadcast Address: `192.168.1.63`
    *   **Subnet 3:**
        *   Network Address: `192.168.1.64` (`192.168.1.32 + 32`)
        *   First Host: `192.168.1.65`
        *   Last Host: `192.168.1.94`
        *   Broadcast Address: `192.168.1.95`
    *   **Subnet 4:**
        *   Network Address: `192.168.1.96` (`192.168.1.64 + 32`)
        *   First Host: `192.168.1.97`
        *   Last Host: `192.168.1.126`
        *   Broadcast Address: `192.168.1.127`
    *   **Subnet 5:**
        *   Network Address: `192.168.1.128` (`192.168.1.96 + 32`)
        *   First Host: `192.168.1.129`
        *   Last Host: `192.168.1.158`
        *   Broadcast Address: `192.168.1.159`
    *   **Subnet 6:**
        *   Network Address: `192.168.1.160` (`192.168.1.128 + 32`)
        *   First Host: `192.168.1.161`
        *   Last Host: `192.168.1.190`
        *   Broadcast Address: `192.168.1.191`
    *   **Subnet 7:**
        *   Network Address: `192.168.1.192` (`192.168.1.160 + 32`)
        *   First Host: `192.168.1.193`
        *   Last Host: `192.168.1.222`
        *   Broadcast Address: `192.168.1.223`
    *   **Subnet 8:**
        *   Network Address: `192.168.1.224` (`192.168.1.192 + 32`)
        *   First Host: `192.168.1.225`
        *   Last Host: `192.168.1.254`
        *   Broadcast Address: `192.168.1.255`

Nh∆∞ v·∫≠y, t·ª´ m·∫°ng `/24` ban ƒë·∫ßu, ch√∫ng ta ƒë√£ t·∫°o ra 8 m·∫°ng `/27` nh·ªè h∆°n, m·ªói m·∫°ng c√≥ 30 Host kh·∫£ d·ª•ng.

### 4. K√Ω Ph√°p CIDR (Classless Inter-Domain Routing)

Nh∆∞ ƒë√£ ƒë·ªÅ c·∫≠p, CIDR l√† c√°ch bi·ªÉu di·ªÖn ƒë·ªãa ch·ªâ m·∫°ng k√®m theo ƒë·ªô d√†i c·ªßa Subnet Mask b·∫±ng d·∫•u `/`. V√≠ d·ª•: `192.168.1.64 /27`.

*   CIDR gi√∫p lo·∫°i b·ªè s·ª± ph·ª• thu·ªôc v√†o c√°c l·ªõp ƒë·ªãa ch·ªâ (Classful A, B, C). B·∫•t k·ª≥ d·∫£i ƒë·ªãa ch·ªâ n√†o c≈©ng c√≥ th·ªÉ ƒë∆∞·ª£c m√¥ t·∫£ b·∫±ng ti·ªÅn t·ªë (prefix) v√† ƒë·ªô d√†i mask.
*   Linh ho·∫°t h∆°n r·∫•t nhi·ªÅu trong vi·ªác c·∫•p ph√°t v√† qu·∫£n l√Ω ƒë·ªãa ch·ªâ IP. Subnetting th·ª±c ch·∫•t l√† m·ªôt ·ª©ng d·ª•ng c·ªßa CIDR.

### 5. VLSM (Variable Length Subnet Mask) - M·∫∑t n·∫° m·∫°ng con c√≥ ƒë·ªô d√†i thay ƒë·ªïi

Trong v√≠ d·ª• tr√™n, ch√∫ng ta chia m·∫°ng g·ªëc th√†nh 8 Subnet c√≥ k√≠ch th∆∞·ªõc **b·∫±ng nhau** (c√πng l√† /27, 30 Host/Subnet). Tuy nhi√™n, trong th·ª±c t·∫ø, c√°c m·∫°ng con c√≥ th·ªÉ c√≥ nhu c·∫ßu s·ªë l∆∞·ª£ng Host kh√°c nhau (v√≠ d·ª•: ph√≤ng K·∫ø to√°n c·∫ßn 20 host, ph√≤ng K·ªπ thu·∫≠t c·∫ßn 50 host, k·∫øt n·ªëi ƒëi·ªÉm-ƒëi·ªÉm gi·ªØa 2 router ch·ªâ c·∫ßn 2 host).

**VLSM** l√† k·ªπ thu·∫≠t cho ph√©p **√°p d·ª•ng c√°c Subnet Mask kh√°c nhau (ƒë·ªô d√†i kh√°c nhau)** cho c√°c Subnet kh√°c nhau ƒë∆∞·ª£c chia ra t·ª´ c√πng m·ªôt m·∫°ng g·ªëc. ƒêi·ªÅu n√†y gi√∫p:

*   **Ti·∫øt ki·ªám ƒë·ªãa ch·ªâ IP t·ªëi ƒëa:** C·∫•p ph√°t Subnet c√≥ k√≠ch th∆∞·ªõc ph√π h·ª£p ch√≠nh x√°c v·ªõi nhu c·∫ßu c·ªßa t·ª´ng m·∫°ng con, tr√°nh l√£ng ph√≠.
*   **Thi·∫øt k·∫ø m·∫°ng hi·ªáu qu·∫£ h∆°n.**

**Nguy√™n t·∫Øc c∆° b·∫£n:** Chia Subnet l·ªõn nh·∫•t tr∆∞·ªõc, sau ƒë√≥ l·∫•y m·ªôt trong c√°c Subnet ch∆∞a s·ª≠ d·ª•ng ƒë·ªÉ ti·∫øp t·ª•c chia nh·ªè h∆°n n·ªØa v·ªõi Mask d√†i h∆°n.

*V√≠ d·ª• (S∆° l∆∞·ª£c):* T·ª´ m·∫°ng `192.168.1.0 /24`:
1. Chia th√†nh `/27` (30 host/subnet) ƒë·ªÉ c·∫•p cho ph√≤ng K·ªπ thu·∫≠t (c·∫ßn 50 - √†, v√≠ d·ª• n√†y kh√¥ng ·ªïn, /27 kh√¥ng ƒë·ªß 50 host, c·∫ßn /26 = 62 host. Gi·∫£ s·ª≠ chia /26 tr∆∞·ªõc).
   *   Subnet 1: `192.168.1.0 /26` (0-63) -> D√πng cho K·ªπ thu·∫≠t (62 host)
   *   Subnet 2: `192.168.1.64 /26` (64-127)
   *   Subnet 3: `192.168.1.128 /26` (128-191)
   *   Subnet 4: `192.168.1.192 /26` (192-255)
2. L·∫•y Subnet 2 (`192.168.1.64 /26`) ti·∫øp t·ª•c chia th√†nh `/28` (14 host/subnet) ƒë·ªÉ c·∫•p cho ph√≤ng K·∫ø to√°n (c·∫ßn 20 - v·∫´n ch∆∞a ƒë·ªß, c·∫ßn /27. V√≠ d·ª• n√†y h∆°i l·ªßng c·ªßng, √Ω t∆∞·ªüng l√† l·∫•y 1 subnet ƒë√£ chia ƒë·ªÉ chia nh·ªè ti·∫øp).
   *   Subnet 2.1: `192.168.1.64 /28` (64-79) -> C·∫•p cho ph√≤ng kh√°c c·∫ßn √≠t h∆°n
   *   Subnet 2.2: `192.168.1.80 /28` (80-95) -> C·∫•p cho K·∫ø to√°n (14 host - OK n·∫øu nhu c·∫ßu l√† 14)
   *   ...
3. L·∫•y m·ªôt Subnet kh√°c (v√≠ d·ª• Subnet 4) chia th√†nh c√°c `/30` (2 host/subnet) cho c√°c k·∫øt n·ªëi point-to-point gi·ªØa c√°c router.
   *   Subnet 4.1: `192.168.1.192 /30` (192-195) -> D√πng cho k·∫øt n·ªëi P2P 1
   *   Subnet 4.2: `192.168.1.196 /30` (196-199) -> D√πng cho k·∫øt n·ªëi P2P 2
   *   ...

VLSM ƒë√≤i h·ªèi k·ªπ nƒÉng t√≠nh to√°n v√† l·∫≠p k·∫ø ho·∫°ch c·∫©n th·∫≠n h∆°n.

## T√≥m T·∫Øt & B√†i H·ªçc Ti·∫øp Theo

Subnetting l√† m·ªôt k·ªπ nƒÉng thi·∫øt y·∫øu cho qu·∫£n tr·ªã vi√™n m·∫°ng, gi√∫p t·ªëi ∆∞u h√≥a vi·ªác s·ª≠ d·ª•ng ƒë·ªãa ch·ªâ IP, c·∫£i thi·ªán hi·ªáu su·∫•t v√† tƒÉng c∆∞·ªùng b·∫£o m·∫≠t b·∫±ng c√°ch chia nh·ªè c√°c mi·ªÅn qu·∫£ng b√°. Ch√∫ng ta ƒë√£ h·ªçc c√°ch "m∆∞·ª£n bit", t√≠nh to√°n s·ªë Subnet, s·ªë Host, v√† x√°c ƒë·ªãnh c√°c th√¥ng tin quan tr·ªçng cho t·ª´ng Subnet. CIDR v√† VLSM l√† nh·ªØng kh√°i ni·ªám n√¢ng cao h∆°n gi√∫p vi·ªác chia Subnet tr·ªü n√™n linh ho·∫°t v√† hi·ªáu qu·∫£.

Sau khi ƒë√£ th√†nh th·∫°o vi·ªác chia ƒë·ªãa ch·ªâ, c√¢u h·ªèi ti·∫øp theo l√†: L√†m th·∫ø n√†o ƒë·ªÉ c√°c Packet bi·∫øt ƒë∆∞·ªùng ƒëi gi·ªØa c√°c Subnet n√†y v√† c√°c m·∫°ng kh√°c tr√™n th·∫ø gi·ªõi? B√†i h·ªçc ti·∫øp theo (`BaiHoc_10_DinhTuyen_Routing.md`) s·∫Ω ƒëi s√¢u v√†o **Qu√° tr√¨nh ƒê·ªãnh tuy·∫øn (Routing)** - tr√°i tim c·ªßa T·∫ßng M·∫°ng. Ch√∫ng ta s·∫Ω t√¨m hi·ªÉu c√°ch Router x√¢y d·ª±ng b·∫£ng ƒë·ªãnh tuy·∫øn v√† ƒë∆∞a ra quy·∫øt ƒë·ªãnh chuy·ªÉn ti·∫øp Packet. H·∫πn g·∫∑p b·∫°n tr√™n nh·ªØng "ng√£ r·∫Ω" c·ªßa m·∫°ng! üõ£Ô∏èüß≠
